{
  "version": 3,
  "sources": ["../../../dist/modules/index.js"],
  "sourcesContent": ["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nexports.__esModule = true;\nexports.initRequirements = exports.sendTransaction = exports.signTransaction = void 0;\nvar nearAPI = require(\"near-api-js\");\nvar js_sha256_1 = require(\"js-sha256\");\nvar config_1 = require(\"../config\");\nfunction signTransaction(_a) {\n    var actions = _a.actions, nonce = _a.nonce, recentBlockHash = _a.recentBlockHash, sender = _a.sender, keyPair = _a.keyPair, contractName = _a.contractName;\n    var publicKey = keyPair.getPublicKey();\n    // create transaction\n    var transaction = nearAPI.transactions.createTransaction(sender, publicKey, contractName, nonce, actions, recentBlockHash);\n    var serializedTx = nearAPI.utils.serialize.serialize(nearAPI.transactions.SCHEMA, transaction);\n    var serializedTxHash = new Uint8Array(js_sha256_1[\"default\"].sha256.array(serializedTx));\n    var signature = keyPair.sign(serializedTxHash);\n    // now we can sign the transaction :)\n    var signedTransaction = new nearAPI.transactions.SignedTransaction({\n        transaction: transaction,\n        signature: new nearAPI.transactions.Signature({\n            keyType: transaction.publicKey.keyType,\n            data: signature.signature\n        })\n    });\n    return signedTransaction;\n}\nexports.signTransaction = signTransaction;\nfunction sendTransaction(provider, signedTransaction) {\n    return __awaiter(this, void 0, void 0, function () {\n        var signedSerializedTx, result, error_1;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    _a.trys.push([0, 2, , 3]);\n                    signedSerializedTx = signedTransaction.encode();\n                    return [4 /*yield*/, provider.sendJsonRpc(\"broadcast_tx_commit\", [\n                            Buffer.from(signedSerializedTx).toString(\"base64\"),\n                        ])];\n                case 1:\n                    result = _a.sent();\n                    // console results :)\n                    console.log(\"Transaction Results: \", JSON.stringify(result === null || result === void 0 ? void 0 : result.transaction));\n                    console.log(\"------------------------------------------------------------------------\");\n                    console.log(\"OPEN LINK BELOW to see transaction in NEAR Explorer!\");\n                    console.log(\"https://explorer.\" + config_1.networkId + \".near.org/transactions/\" + (result === null || result === void 0 ? void 0 : result.transaction.hash));\n                    console.log(\"------------------------------------------------------------------------\");\n                    return [3 /*break*/, 3];\n                case 2:\n                    error_1 = _a.sent();\n                    console.log(error_1);\n                    return [3 /*break*/, 3];\n                case 3: return [2 /*return*/];\n            }\n        });\n    });\n}\nexports.sendTransaction = sendTransaction;\nfunction initRequirements(_a) {\n    var provider = _a.provider, sender = _a.sender, publicKey = _a.publicKey;\n    return __awaiter(this, void 0, void 0, function () {\n        var _this = this;\n        return __generator(this, function (_b) {\n            return [2 /*return*/, new Promise(function (resolve, reject) { return __awaiter(_this, void 0, void 0, function () {\n                    var accessKey, nonce, recentBlockHash;\n                    return __generator(this, function (_a) {\n                        switch (_a.label) {\n                            case 0: return [4 /*yield*/, provider.query(\"access_key/\" + sender + \"/\" + publicKey, \"\")];\n                            case 1:\n                                accessKey = _a.sent();\n                                // checks to make sure provided key is a full access key\n                                if (accessKey.permission !== \"FullAccess\") {\n                                    reject(new Error(\"Account [ \" + sender + \" ] does not have permission to send tokens using key: [ \" + publicKey + \" ]\"));\n                                }\n                                nonce = ++accessKey.nonce;\n                                recentBlockHash = nearAPI.utils.serialize.base_decode(accessKey.block_hash);\n                                resolve({ accessKey: accessKey, nonce: nonce, recentBlockHash: recentBlockHash });\n                                return [2 /*return*/];\n                        }\n                    });\n                }); })];\n        });\n    });\n}\nexports.initRequirements = initRequirements;\n"],
  "mappings": "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",
  "names": []
}
